<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hillary Clinton Emails</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Google Sans', Roboto, Arial, sans-serif; background: #f6f8fc; color: #202124; }

  /* Header */
  .header {
    background: #fff; height: 64px; display: flex; align-items: center;
    padding: 0 16px; border-bottom: 1px solid #e0e0e0; position: fixed;
    top: 0; left: 0; right: 0; z-index: 100;
  }
  .header .logo { display: flex; align-items: center; gap: 8px; width: 250px; }
  .header .logo svg { width: 40px; height: 40px; }
  .header .logo span { font-size: 22px; color: #5f6368; font-weight: 500; }
  .header .logo .title { color: #c5221f; font-weight: 600; }
  .search-bar {
    flex: 1; max-width: 720px; background: #eaf1fb; border-radius: 28px;
    display: flex; align-items: center; padding: 0 16px; height: 48px;
  }
  .search-bar input {
    flex: 1; border: none; background: none; font-size: 16px;
    outline: none; color: #202124; padding: 0 12px;
  }
  .search-bar svg { color: #5f6368; cursor: pointer; flex-shrink: 0; }
  .header-right { margin-left: auto; display: flex; align-items: center; gap: 8px; }
  .avatar {
    width: 36px; height: 36px; border-radius: 50%; background: #1a73e8;
    color: #fff; display: flex; align-items: center; justify-content: center;
    font-weight: 600; font-size: 14px;
  }

  /* Layout */
  .container { display: flex; margin-top: 64px; min-height: calc(100vh - 64px); }

  /* Sidebar */
  .sidebar {
    width: 250px; padding: 8px 12px; flex-shrink: 0; position: fixed;
    top: 64px; bottom: 0; overflow-y: auto;
  }
  .compose-btn {
    background: #c2e7ff; border: none; border-radius: 16px; padding: 14px 24px;
    font-size: 14px; font-weight: 600; cursor: pointer; display: flex;
    align-items: center; gap: 12px; margin-bottom: 12px; width: fit-content;
    color: #001d35; transition: box-shadow 0.2s;
  }
  .compose-btn:hover { box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
  .nav-item {
    display: flex; align-items: center; gap: 16px; padding: 6px 12px;
    border-radius: 24px; cursor: pointer; font-size: 14px; color: #444746;
    margin-bottom: 2px; position: relative;
  }
  .nav-item:hover { background: #e8eaed; }
  .nav-item.active { background: #d3e3fd; color: #001d35; font-weight: 600; }
  .nav-item .count {
    margin-left: auto; font-size: 12px; font-weight: 600;
  }
  .nav-item svg { width: 20px; height: 20px; flex-shrink: 0; }

  /* Email List */
  .main { flex: 1; margin-left: 250px; }
  .toolbar {
    display: flex; align-items: center; padding: 4px 16px; gap: 4px;
    background: #f6f8fc; border-bottom: 1px solid #e0e0e0; position: sticky;
    top: 64px; z-index: 50; height: 48px;
  }
  .toolbar button {
    background: none; border: none; cursor: pointer; padding: 8px;
    border-radius: 50%; color: #5f6368;
  }
  .toolbar button:hover { background: #e8eaed; }
  .toolbar .page-info { margin-left: auto; font-size: 12px; color: #5f6368; }

  .email-list { background: #fff; }
  .email-row {
    display: flex; align-items: center; padding: 0 16px; height: 40px;
    border-bottom: 1px solid #f1f3f4; cursor: pointer; font-size: 14px;
    transition: box-shadow 0.15s;
  }
  .email-row:hover { box-shadow: inset 1px 0 0 #dadce0, inset -1px 0 0 #dadce0, 0 1px 2px 0 rgba(60,64,67,.3); z-index: 1; }
  .email-row.unread { font-weight: 600; background: #fff; }
  .email-row.read { background: #f2f6fc; }
  .email-row.selected { background: #c2dbff; }

  .email-row .checkbox { width: 40px; flex-shrink: 0; display: flex; align-items: center; }
  .email-row .checkbox input { width: 18px; height: 18px; cursor: pointer; accent-color: #1a73e8; }
  .email-row .star { width: 32px; flex-shrink: 0; cursor: pointer; color: #dadce0; font-size: 18px; }
  .email-row .star.starred { color: #f4b400; }
  .email-row .sender { width: 200px; flex-shrink: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .email-row .subject-snippet { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .email-row .subject-snippet .snippet { color: #5f6368; font-weight: 400; }
  .email-row .date { width: 80px; text-align: right; flex-shrink: 0; font-size: 12px; color: #5f6368; }
  .email-row.unread .date { color: #202124; font-weight: 600; }

  /* Email Detail View */
  .email-detail { display: none; background: #fff; min-height: calc(100vh - 112px); }
  .email-detail.active { display: block; }
  .email-list.hidden { display: none; }

  .detail-toolbar {
    display: flex; align-items: center; padding: 8px 16px; gap: 4px;
    border-bottom: 1px solid #e0e0e0; position: sticky; top: 64px;
    background: #fff; z-index: 50;
  }
  .detail-toolbar button {
    background: none; border: none; cursor: pointer; padding: 8px;
    border-radius: 50%; color: #5f6368; font-size: 18px;
  }
  .detail-toolbar button:hover { background: #e8eaed; }

  .detail-content { padding: 20px 60px; max-width: 900px; }
  .detail-subject { font-size: 22px; font-weight: 400; color: #202124; margin-bottom: 20px; line-height: 1.4; }
  .detail-header { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 24px; }
  .detail-avatar {
    width: 40px; height: 40px; border-radius: 50%; background: #a142f4;
    color: #fff; display: flex; align-items: center; justify-content: center;
    font-weight: 600; font-size: 16px; flex-shrink: 0;
  }
  .detail-meta { flex: 1; }
  .detail-from { font-weight: 600; font-size: 14px; }
  .detail-to { font-size: 12px; color: #5f6368; margin-top: 2px; }
  .detail-date-full { font-size: 12px; color: #5f6368; white-space: nowrap; }
  .detail-body {
    font-size: 14px; line-height: 1.6; color: #202124;
    white-space: pre-wrap; word-wrap: break-word;
  }

  /* Labels */
  .label {
    display: inline-block; padding: 2px 8px; border-radius: 4px;
    font-size: 11px; font-weight: 600; margin-left: 8px; vertical-align: middle;
  }
  .label-inbox { background: #e8f0fe; color: #1967d2; }

  /* No selection */
  .empty-state {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 300px; color: #5f6368; font-size: 14px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .sidebar { display: none; }
    .main { margin-left: 0; }
    .email-row .sender { width: 120px; }
    .detail-content { padding: 16px; }
  }
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="logo">
    <svg viewBox="0 0 40 40" fill="none">
      <rect width="40" height="40" rx="8" fill="#ea4335"/>
      <path d="M8 12l12 9 12-9v18H8z" fill="#fff" opacity="0.9"/>
      <path d="M8 12l12 9 12-9" stroke="#fff" stroke-width="1.5" fill="none"/>
    </svg>
    <span><span class="title">HRC</span> Mail</span>
  </div>
  <div class="search-bar">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
    <input type="text" id="searchInput" placeholder="Search mail" oninput="filterEmails()">
  </div>
  <div class="header-right">
    <div class="avatar">HC</div>
  </div>
</div>

<!-- Container -->
<div class="container">
  <!-- Sidebar -->
  <div class="sidebar">
    <button class="compose-btn">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
      Compose
    </button>
    <div class="nav-item active" onclick="showInbox()">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5v-3h3.56c.69 1.19 1.97 2 3.45 2s2.75-.81 3.45-2H19v3zm0-5h-4.99c0 1.1-.9 2-2 2s-2-.9-2-2H5V5h14v9z"/></svg>
      Inbox
      <span class="count" id="inboxCount"></span>
    </div>
    <div class="nav-item" onclick="showStarred()">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
      Starred
      <span class="count" id="starredCount">0</span>
    </div>
    <div class="nav-item">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"/></svg>
      All Mail
    </div>
  </div>

  <!-- Main Content -->
  <div class="main">
    <!-- Toolbar -->
    <div class="toolbar" id="listToolbar">
      <button title="Select" onclick="toggleSelectAll()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z"/></svg>
      </button>
      <button title="Refresh" onclick="location.reload()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
      </button>
      <span class="page-info" id="pageInfo"></span>
    </div>

    <!-- Email List -->
    <div class="email-list" id="emailList"></div>

    <!-- Email Detail -->
    <div class="email-detail" id="emailDetail">
      <div class="detail-toolbar">
        <button title="Back to inbox" onclick="closeDetail()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
        </button>
        <button title="Archive">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5L6.5 12H10v-2h4v2h3.5L12 17.5zM5.12 5l.81-1h12l.94 1H5.12z"/></svg>
        </button>
        <button title="Delete">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
        </button>
      </div>
      <div class="detail-content" id="detailContent"></div>
    </div>
  </div>
</div>

<script>
let emails = [];
let starredIds = new Set();
let readIds = new Set();
let currentView = 'inbox';

const colors = ['#a142f4','#1a73e8','#ea4335','#34a853','#fa7b17','#f538a0','#00897b','#e37400'];

function getInitials(name) {
  if (!name) return '?';
  const clean = name.replace(/<[^>]*>/g, '').replace(/"/g, '').trim();
  const parts = clean.split(/[\s,]+/).filter(Boolean);
  if (parts.length >= 2) return (parts[0][0] + parts[1][0]).toUpperCase();
  return clean.substring(0, 2).toUpperCase();
}

function getColor(name) {
  let hash = 0;
  for (let i = 0; i < (name||'').length; i++) hash = ((hash << 5) - hash) + name.charCodeAt(i);
  return colors[Math.abs(hash) % colors.length];
}

function formatSender(from) {
  if (!from) return 'Unknown';
  const match = from.match(/^([^<]+)/);
  return match ? match[1].replace(/"/g,'').trim() : from;
}

function formatDate(dateStr) {
  if (!dateStr) return '';
  try {
    const d = new Date(dateStr);
    const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    return months[d.getMonth()] + ' ' + d.getDate();
  } catch { return ''; }
}

function formatDateFull(dateStr) {
  if (!dateStr) return '';
  try {
    const d = new Date(dateStr);
    return d.toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: '2-digit' });
  } catch { return dateStr; }
}

function getSnippet(body) {
  if (!body) return '';
  const clean = body.replace(/\n/g, ' ').replace(/\s+/g, ' ').trim();
  return clean.length > 100 ? clean.substring(0, 100) + '...' : clean;
}

function renderEmailList(list) {
  const el = document.getElementById('emailList');
  if (list.length === 0) {
    el.innerHTML = '<div class="empty-state"><p>No emails match your search.</p></div>';
    document.getElementById('pageInfo').textContent = '';
    return;
  }
  document.getElementById('pageInfo').textContent = `1\u2013${list.length} of ${list.length}`;

  el.innerHTML = list.map((e, i) => {
    const isRead = readIds.has(e.Id);
    const isStarred = starredIds.has(e.Id);
    const sender = formatSender(e.MetadataFrom || e.ExtractedFrom || 'Unknown');
    return `
      <div class="email-row ${isRead ? 'read' : 'unread'}" data-id="${e.Id}" onclick="openEmail(${e.Id})">
        <div class="checkbox"><input type="checkbox" onclick="event.stopPropagation()"></div>
        <div class="star ${isStarred ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar(${e.Id})">
          ${isStarred ? '&#9733;' : '&#9734;'}
        </div>
        <div class="sender">${escHtml(sender)}</div>
        <div class="subject-snippet">
          ${escHtml(e.MetadataSubject || '(no subject)')}
          <span class="snippet"> &mdash; ${escHtml(getSnippet(e.ExtractedBodyText))}</span>
        </div>
        <div class="date">${formatDate(e.MetadataDateSent)}</div>
      </div>`;
  }).join('');
}

function escHtml(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

function openEmail(id) {
  const email = emails.find(e => e.Id === id);
  if (!email) return;
  readIds.add(id);

  const sender = formatSender(email.MetadataFrom || 'Unknown');
  const initials = getInitials(sender);
  const color = getColor(sender);

  document.getElementById('detailContent').innerHTML = `
    <div class="detail-subject">${escHtml(email.MetadataSubject || '(no subject)')}<span class="label label-inbox">Inbox</span></div>
    <div class="detail-header">
      <div class="detail-avatar" style="background:${color}">${initials}</div>
      <div class="detail-meta">
        <div class="detail-from">${escHtml(sender)}</div>
        <div class="detail-to">to ${escHtml(email.MetadataTo || 'me')}</div>
      </div>
      <div class="detail-date-full">${formatDateFull(email.MetadataDateSent)}</div>
    </div>
    <div class="detail-body">${escHtml(email.ExtractedBodyText || '')}</div>
  `;

  document.getElementById('emailList').classList.add('hidden');
  document.getElementById('listToolbar').style.display = 'none';
  document.getElementById('emailDetail').classList.add('active');

  renderEmailList(getFilteredEmails());
}

function closeDetail() {
  document.getElementById('emailDetail').classList.remove('active');
  document.getElementById('emailList').classList.remove('hidden');
  document.getElementById('listToolbar').style.display = '';
  renderEmailList(getFilteredEmails());
}

function toggleStar(id) {
  if (starredIds.has(id)) starredIds.delete(id);
  else starredIds.add(id);
  document.getElementById('starredCount').textContent = starredIds.size;
  renderEmailList(getFilteredEmails());
}

function getFilteredEmails() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  let list = currentView === 'starred' ? emails.filter(e => starredIds.has(e.Id)) : emails;
  if (query) {
    list = list.filter(e =>
      (e.MetadataSubject || '').toLowerCase().includes(query) ||
      (e.MetadataFrom || '').toLowerCase().includes(query) ||
      (e.MetadataTo || '').toLowerCase().includes(query) ||
      (e.ExtractedBodyText || '').toLowerCase().includes(query)
    );
  }
  return list;
}

function filterEmails() { renderEmailList(getFilteredEmails()); }
function showInbox() {
  currentView = 'inbox';
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.querySelectorAll('.nav-item')[1].classList.add('active');
  closeDetail();
}
function showStarred() {
  currentView = 'starred';
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.querySelectorAll('.nav-item')[2].classList.add('active');
  closeDetail();
}

// Load data
fetch('emails.json')
  .then(r => r.json())
  .then(data => {
    emails = data.sort((a, b) => new Date(b.MetadataDateSent || 0) - new Date(a.MetadataDateSent || 0));
    // Mark ~60% as read for realism
    emails.slice(Math.floor(emails.length * 0.4)).forEach(e => readIds.add(e.Id));
    document.getElementById('inboxCount').textContent = emails.filter(e => !readIds.has(e.Id)).length;
    renderEmailList(emails);
  });

// Keyboard shortcut
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeDetail();
});
</script>
</body>
</html>
